if(NOT DANDELION_SYSTEM)
set(DANDELION_SYSTEM "debug")
endif()

if(DANDELION_SYSTEM MATCHES "debug")
  add_subdirectory(debug)
elseif(DANDELION_SYSTEM MATCHES "cheri")
  add_subdirectory(cheri)
elseif(DANDELION_SYSTEM MATCHES "mmu_freebsd")
  add_subdirectory(mmu_freebsd)
elseif(DANDELION_SYSTEM MATCHES "mmu_linux")
  add_subdirectory(mmu_linux)
else()
  message(FATAL_ERROR "Invalid system: ${DANDELION_SYSTEM}")
endif()
message(STATUS "Using system: ${DANDELION_SYSTEM}")

target_sources(${SYSTEM_LIB} PRIVATE system.c)
target_compile_options(${SYSTEM_LIB} PRIVATE -nostdlib)